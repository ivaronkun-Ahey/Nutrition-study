<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="–û–±—É—á–∞—é—â–∞—è –∏–≥—Ä–∞ –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–∏—Ç–∞–Ω–∏–∏ - –∏–∑—É—á–∞–π—Ç–µ –∫–∞–ª–æ—Ä–∏–∏, –±–µ–ª–∫–∏, —É–≥–ª–µ–≤–æ–¥—ã, –∂–∏—Ä—ã –∏ –≤–∏—Ç–∞–º–∏–Ω—ã –≤ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ">
    <title>Nutrition Quest - –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –º–∏—Ä –ø–∏—Ç–∞–Ω–∏—è</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div id="game-container"></div>

    <!-- Loading indicator -->
    <div id="loading-indicator" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; text-align: center; font-family: Arial, sans-serif; z-index: 1000;">
        <h1 style="font-size: 48px; margin-bottom: 20px;">üéÆ Nutrition Quest</h1>
        <p style="font-size: 24px; margin-bottom: 10px;">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</p>
        <div style="width: 300px; height: 30px; background: rgba(255,255,255,0.2); border-radius: 15px; overflow: hidden; margin: 20px auto;">
            <div id="loading-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); transition: width 0.3s;"></div>
        </div>
        <p id="loading-status" style="font-size: 16px; color: #ddd;">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...</p>
    </div>

    <!-- Helper function to update loading progress -->
    <script>
        function updateProgress(percent, status) {
            const bar = document.getElementById('loading-bar');
            const statusEl = document.getElementById('loading-status');
            if (bar) bar.style.width = percent + '%';
            if (statusEl) statusEl.textContent = status;
        }

        // Global error handler
        window.addEventListener('error', function(e) {
            console.error('‚ùå JavaScript Error:', e.error);
            const indicator = document.getElementById('loading-indicator');
            if (indicator) {
                indicator.innerHTML = '<div style="color: white; text-align: center; padding: 50px; font-family: Arial;"><h1 style="color: #ff6b6b;">‚ö†Ô∏è –û—à–∏–±–∫–∞</h1><p style="font-size: 20px;">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–≥—Ä—ã</p><p style="font-size: 16px; color: #ddd; margin-top: 20px;">' + e.message + '</p><p style="font-size: 14px; margin-top: 10px;">–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π</p><button onclick="location.reload()" style="margin-top: 20px; padding: 10px 30px; font-size: 18px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button></div>';
            }
            return false;
        });

        updateProgress(5, '–ó–∞–≥—Ä—É–∑–∫–∞ Phaser...');
    </script>

    <!-- Phaser 3 from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    <script>updateProgress(15, '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');</script>

    <!-- Config - Must load FIRST as it defines COLORS, FONTS, etc. used by other files -->
    <script src="src/config.js"></script>
    <script>updateProgress(25, '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');</script>

    <!-- Data files -->
    <script src="src/data/nutrients.js"></script>
    <script src="src/data/foods.js"></script>
    <script src="src/data/questions.js"></script>
    <script src="src/data/educational.js"></script>
    <script>updateProgress(40, '–ó–∞–≥—Ä—É–∑–∫–∞ —É—Ç–∏–ª–∏—Ç...');</script>

    <!-- Utils -->
    <script src="src/utils/DataManager.js"></script>
    <script src="src/utils/ProgressManager.js"></script>
    <script>updateProgress(50, '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤...');</script>

    <!-- Components -->
    <script src="src/components/Button.js"></script>
    <script src="src/components/Card.js"></script>
    <script src="src/components/Dialog.js"></script>
    <script src="src/components/ProgressBar.js"></script>
    <script>updateProgress(65, '–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω...');</script>

    <!-- Scenes -->
    <script src="src/scenes/BootScene.js"></script>
    <script src="src/scenes/MenuScene.js"></script>
    <script src="src/scenes/LevelSelectScene.js"></script>
    <script src="src/scenes/ReferenceScene.js"></script>
    <script src="src/scenes/TrackerScene.js"></script>
    <script>updateProgress(80, '–ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–≤–Ω–µ–π...');</script>

    <!-- Level Scenes -->
    <script src="src/scenes/levels/Level1_Calories.js"></script>
    <script src="src/scenes/levels/Level2_Proteins.js"></script>
    <script src="src/scenes/levels/Level3_Carbs.js"></script>
    <script src="src/scenes/levels/Level4_Fats.js"></script>
    <script src="src/scenes/levels/Level5_Vitamins.js"></script>
    <script src="src/scenes/levels/Level6_Balance.js"></script>
    <script src="src/scenes/levels/Level7_Needs.js"></script>
    <script src="src/scenes/levels/Level8_Digestion.js"></script>
    <script>updateProgress(95, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');</script>

    <!-- Main - Initialize game -->
    <script src="src/main.js"></script>
</body>
</html>
